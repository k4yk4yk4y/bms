<% if @current_project.present? && @permanent_bonuses.present? %>
  <div class="card mb-4">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">
        <i class="fas fa-star text-warning"></i> Permanent Bonuses for <%= @current_project.name %>
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-3">
        <% @permanent_bonuses.each do |bonus| %>
          <div class="col-xl-3 col-lg-4 col-md-6">
            <div class="card h-100 shadow-sm">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-start mb-2">
                  <h6 class="card-title mb-0">
                    <%= link_to bonus.name, bonus_path(bonus), class: "text-decoration-none" %>
                  </h6>
                  <span class="badge bg-warning text-dark">
                    <i class="fas fa-star"></i> Permanent
                  </span>
                </div>
                
                <div class="small mb-2">
                  <code class="text-dark"><%= bonus.display_code %></code>
                </div>
                
                <% if bonus.description.present? %>
                  <p class="card-text small text-muted mb-2" style="max-height: 3em; overflow: hidden;">
                    <%= truncate(bonus.description, length: 80) %>
                  </p>
                <% end %>
                
                <div class="d-flex gap-2 flex-wrap">
                  <span class="badge bg-secondary">
                    <%= bonus.event.humanize %>
                  </span>
                  <span class="badge <%= bonus.status == 'active' ? 'bg-success' : 'bg-secondary' %>">
                    <%= bonus.status.humanize %>
                  </span>
                  <% if bonus.dsl_tag.present? %>
                    <span class="badge bg-info">
                      <%= bonus.dsl_tag %>
                    </span>
                  <% end %>
                </div>
                
                <div class="mt-3">
                  <div class="btn-group btn-group-sm w-100" role="group">
                    <%= link_to bonus_path(bonus), class: "btn btn-outline-info" do %>
                      <i class="fas fa-eye"></i> View
                    <% end %>
                    <% if can?(:update, bonus) %>
                      <%= link_to edit_bonus_path(bonus), class: "btn btn-outline-primary" do %>
                        <i class="fas fa-edit"></i> Edit
                      <% end %>
                    <% end %>
                  </div>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      </div>
      
      <div class="mt-3 text-muted small">
        <i class="fas fa-info-circle"></i> 
        These bonuses are marked as permanent for <%= @current_project.name %> project.
        <% if current_user.is_a?(AdminUser) || (current_user.is_a?(User) && current_user.admin?) %>
          Manage permanent bonuses in the 
          <%= link_to "Admin Panel", admin_permanent_bonuses_path(q: { project_id_eq: @current_project.id }), target: "_blank", class: "text-decoration-none" %>.
        <% end %>
      </div>
    </div>
  </div>
<% elsif @current_project.present? && @permanent_bonuses.empty? %>
  <div class="alert alert-info mb-4" role="alert">
    <i class="fas fa-info-circle"></i>
    <strong>No permanent bonuses configured</strong> for <%= @current_project.name %> project yet.
    <% if current_user.is_a?(AdminUser) || (current_user.is_a?(User) && current_user.admin?) %>
      <%= link_to "Add permanent bonuses", admin_permanent_bonuses_path, target: "_blank", class: "alert-link" %> in the Admin Panel.
    <% end %>
  </div>
<% end %>

